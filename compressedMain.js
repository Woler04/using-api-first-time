var posts,score=0,highScore=0,postId=0,currRound=1;const currRoundText=document.getElementById("currRound"),roundText=document.getElementById("rounds"),roundRange=document.getElementById("roundRange"),pid=Math.floor(200*Math.random())+1;function setup(){currRoundText.textContent=currRound,roundRange.value=15,roundText.textContent=roundRange.value,url="https://api.rule34.xxx/index.php?page=dapi&s=post&q=index&json=1&limit=1000&pid="+pid,getJSON(url,function(a,b){null===a?(posts=b,rend()):console.log("Something went wrong: "+a)})}var getJSON=function(a,b){var c=new XMLHttpRequest;c.open("GET",a,!0),c.responseType="json",c.send(),c.onload=function(){var a=c.status;200===a?b(null,c.response):b(a,c.response)}};function rend(){currRound>roundRange.value&&newGame(),currRoundText.textContent=currRound++,postId=Math.floor(Math.random()*posts.length),(posts[postId]==null||null==posts[postId])&&rend(),createImage(posts[postId])}function check(){let a=document.getElementById("tagList");a.setAttribute("placeholder","Write tags separated by space ex.: anal sus head bitches etc."),score=scoreSum(a.value,posts[postId].tags),document.getElementById("score").textContent="Score: "+score,rend()}function newGame(){currRound=1,roundText.textContent=roundRange.value,score>highScore&&(highScore=score,document.getElementById("highScore").textContent=highScore),score=0,document.getElementById("score").textContent="Score: "+score}function scoreSum(a,b){let c=b.split(" ").map(a=>a.toLowerCase()),d=a.split(" ").map(a=>a.toLowerCase());c.sort(function(c,a){const b=c.toUpperCase(),d=a.toUpperCase();return b<d?-1:b>d?1:0}),d.sort(function(c,a){const b=c.toUpperCase(),d=a.toUpperCase();return b<d?-1:b>d?1:0}),console.log("answer: "+c.join()),console.log("your answer: "+d.join()),document.getElementById("prvTags").textContent=c.join(" ");(function(){return c.length>d.length?c.length:d.length})();for(let e=0;e<d.length;e++)c.includes(d[e])&&(score+=10,console.log(d[e]));return postId=Math.floor(Math.random()*posts.length)+1,score}function createImage(a){let b=document.getElementById("guessImg"),c=a.preview_url;b.setAttribute("src",c),b.setAttribute("style",`width:auto; height:35vh;`),b.setAttribute("alt","no bitches?"),document.getElementById("r34page").textContent=a.file_url,document.getElementById("r34page").setAttribute("href",a.file_url)}function sliderChange(){return roundRange.value<=currRound?void(document.getElementById("roundRangeValue").textContent=roundRange.value+" IF LESS THAN/OR EQUAL TO CURENT ROUND IT WILL APPLY AFTER THE GAME"):void(roundText.textContent=roundRange.value,document.getElementById("roundRangeValue").textContent=roundRange.value)}setup();